{% import "macros/helpers.html.twig" as helpers %}
{% extends 'base.html.twig' %}

{% block content %}
    <h1>{{ ship.symbol }}</h1>
    <div class="flex">
        <div class="card card-one-third">
            <h2 class="title">Navigation</h2>
            <div class="info">
                <p><b>Waypoint:</b> {{ ship.nav.waypointSymbol }}</p>
                <h3>Route</h3>
                {% include 'partials/ship-nav-table.html.twig'
                    with {'nav' : ship.nav} %}

                <h3>Ship Orders</h3>

                <form action="/ship/orders" method="post"
                    up-submit
                    up-target=".ship-nav-status, .ship-cooldown"
                    up-transition="cross-fade"
                >
                    <input type="hidden" name="ship" value="{{ ship.symbol }}">
                    <select name="order" required>
                        <option disabled>--Select Order--</option>
                        <option value="orbit">Orbit</option>
                        <option value="dock">Dock</option>
                        <option value="extract">Extract</option>
                        <option value="refuel">Refuel</option>
                    </select>
                    <input type="submit" value="Issue Order">
                </form>

                <h3>Navigate</h3>
                <form action="/ship/navigate" target="_blank" method="post"
                    up-submit
                    up-target=".ship-nav-status, .ship-fuel"
                    up-transition="cross-fade"
                >
                    <input type="hidden" name="ship" value="{{ ship.symbol }}">
                    <input type="text" name="waypoint"
                           placeholder="waypoint" required>
                    <input type="submit" value="Navigate Ship">
                </form>

                <h3>Set Flight Mode</h3>
                <form action="/ship/set-flight-mode" method="post"
                    up-submit
                    up-target=".ship-nav-status, .ship-fuel"
                    up-transition="cross-fade"
                >
                    <input type="hidden" name="ship" value="{{ ship.symbol }}">
                    <select name="flightmode" required>
                        <option value="">--Select Flight Mode--</option>
                        {{ helpers.select_options(flightModes) }}
                    </select>
                    <input type="submit" value="Set Flight Mode">
                </form>
            </div>
        </div>

        <div class="card card-one-third">
            <h2 class="title">Data</h2>
            <div class="info">
                <h3>Fuel</h3>
                {% include 'partials/ship-fuel-table.html.twig'
                    with {'fuel' : ship.fuel} %}

                <h3>Cooldown</h3>
                {% include 'partials/ship-cooldown-table.html.twig'
                    with {'cooldown': ship.cooldown }
                %}
            </div>
        </div>
        <div class="card card-one-third">
            <h2 class="title">Crew</h2>
            <div class="info">
                <table>
                    <tr>
                        <th>Current</th>
                        <th>Capacity</th>
                        <th>Required</th>
                    </tr>
                    <tr>
                        <td>{{ ship.crew.current }}</td>
                        <td>{{ ship.crew.capacity }}</td>
                        <td>{{ ship.crew.required }}</td>
                    </tr>
                    <tr>
                        <th>Morale</th>
                        <th>Wages</th>
                        <th>Rotation</th>
                    </tr>
                    <tr>
                        <td>{{ ship.crew.morale }}</td>
                        <td>{{ ship.crew.wages|number_format }}</td>
                        <td>{{ ship.crew.rotation.value|machine2readable }}</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="card card-one-third">
            <h2 class="title">Frame - {{ ship.frame.name }}</h2>
            <p>{{ ship.frame.description }}</p>
            <div class="info">
                {% include 'partials/ship-frame-table.html.twig'
                    with {'ship' : ship} %}
            </div>
        </div>

        <div class="card card-one-third">
            <h2 class="title">Reactor - {{ ship.reactor.name }}</h2>
            <p>{{ ship.reactor.description }}</p>
            <div class="info">
                {% include 'partials/ship-reactor-table.html.twig'
                    with {'ship' : ship} %}
            </div>
        </div>

        <div class="card card-one-third">
            <h2 class="title">Engine - {{ ship.engine.name }}</h2>
            <p>{{ ship.engine.description }}</p>
            <div class="info">
                {% include 'partials/ship-engine-table.html.twig'
                    with {'ship' : ship} %}
            </div>
        </div>

        <div class="card card-one-third">
            <h2 class="title">Modules</h2>
            <div class="info">
                {% for modules in ship.modules %}
                    <h3>{{ modules.name }}</h3>
                    <p>{{ modules.description }}</p>
                    <p><em>Requires {{ modules.requirements.crew }} crew,
                            {{ modules.requirements.power }} power, and
                            {{ modules.requirements.slots }} slots. Capacity {{ modules.capacity }}</em>
                    </p>
                {% endfor %}
            </div>
        </div>

        <div class="card card-one-third">
            <h2 class="title">Mounts</h2>
            <div class="info">
                {% for mount in ship.mounts %}
                    <h3>{{ mount.name }}</h3>
                    <p>{{ mount.description }}</p>
                    <p><em>Requires {{ mount.requirements.crew }} crew and
                            {{ mount.requirements.power }} power. Strength {{ mount.strength }}</em>
                    </p>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}